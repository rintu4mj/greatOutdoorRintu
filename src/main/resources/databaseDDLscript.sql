/* User Database*/
CREATE TABLE `iMIuEwHYH8`.`USER` ( `USER_NAME` VARCHAR(50) NOT NULL ,
`USER_ID` VARCHAR(20) NOT NULL ,  `USER_MAIL` VARCHAR(30) NOT NULL , 
`USER_PASSWORD` VARCHAR(20) NOT NULL ,  `USER_CONTACT` BIGINT(10) NOT NULL , 
`USER_CATEGORY` INT(1) NOT NULL ,
`USER_ACTIVE_STATUS` BOOLEAN NOT NULL DEFAULT FALSE , 
PRIMARY KEY  (`USER_ID`(20)), 
UNIQUE  `CK1` (`USER_MAIL`), 
UNIQUE  `CK2` (`USER_CONTACT`)) ENGINE = InnoDB;



/*Retailer Inventory Store*/
CREATE TABLE `iMIuEwHYH8`.`retailer_inventory_item_timestamps` (
`retailer_id` VARCHAR(10) NOT NULL COMMENT 'To store the Retailer ID', 
`item_id` VARCHAR(10) NOT NULL COMMENT 'To store the Item/Product ID',  
`item_dispatch_timestamp` DATETIME COMMENT 'To store the time at which item/product left the GO warehouse',
`item_received_timestamp` DATETIME COMMENT 'To store the time at which item/product is received by retailer',
`item_sale_timestamp` DATETIME COMMENT 'To store the time at which retailer sells item/product to consumer',
PRIMARY KEY  (`retailer_id`, `item_id`)) ENGINE = InnoDB;


/* PRODUCT DATABASE */
CREATE TABLE `iMIuEwHYH8`.`PRODUCT` ( `PRODUCT_ID` VARCHAR(20) NOT NULL ,
`PRODUCT_PRICE` DOUBLE NOT NULL ,
`PRODUCT_COLOUR` VARCHAR(20) NOT NULL ,
`PRODUCT_DIMENSION` VARCHAR(30) NOT NULL ,
`PRODUCT_QUANTITY` INT NOT NULL ,
`PRODUCT_SPECIFICATION` VARCHAR(50) NOT NULL ,
`PRODUCT_CATEGORY` INT(1) NOT NULL ,
`PRODUCT_MANUFACTURER` VARCHAR(50) NOT NULL , \
`PRODUCT_NAME` VARCHAR(100) NOT NULL , 
PRIMARY KEY (`PRODUCT_ID`)) ENGINE = InnoDB

/*CART*/
CREATE TABLE `iMIuEwHYH8`.`CART` ( `CART_ID` VARCHAR(20) NOT NULL ,
`PRODUCT_ID` VARCHAR(20) NOT NULL ,
`PRODUCT_UIN` VARCHAR(20) NOT NULL ,
PRIMARY KEY (`CART_ID`, `PRODUCT_ID`, `PRODUCT_UIN`)) ENGINE = InnoDB;

/*PRODUCT_UIN_MAP*/
CREATE TABLE `iMIuEwHYH8`.`PRODUCT_UIN_MAP` ( `PRODUCT_ID` VARCHAR(20) NOT NULL,
`PRODUCT_UIN` VARCHAR(20) NOT NULL ,
`PRODUCT_IS_PRESENT` BOOLEAN NOT NULL , 
PRIMARY KEY (`PRODUCT_ID`, `PRODUCT_UIN`)),
FOREIGN KEY(PRODUCT_ID) REFERENCES PRODUCT(PRODUCT_ID) ENGINE = InnoDB;

/*ADDRESS*/
CREATE TABLE `iMIuEwHYH8`.`ADDRESS` ( `ADDRESS_ID` VARCHAR(10) NOT NULL , 
`USER_ID` VARCHAR(20) NOT NULL ,
`CITY` VARCHAR(20) NOT NULL , 
`STATE` VARCHAR(20) NOT NULL ,
`ZIP` VARCHAR(20) NOT NULL , 
`BUILDING_NO` VARCHAR(20) NOT NULL ,
`COUNTRY` VARCHAR(20) NOT NULL ,
`BASE_ADDRESS_STATUS` BOOLEAN NOT NULL DEFAULT FALSE ,
PRIMARY KEY (`ADDRESS_ID`, `USER_ID`),
FOREIGN KEY(USER_ID) REFERENCES USER(USER_ID))ENGINE = InnoDB;

/*ORDER*/
CREATE TABLE `iMIuEwHYH8`.`ORDER` ( `ORDER_ID` VARCHAR(20) NOT NULL , 
`ORDER_DISPATCH_STATUS` BOOLEAN NOT NULL DEFAULT FALSE , 
`ORDER_DISPATCH_TIME` DATETIME(10) NULL ,
`USER_ID` VARCHAR(20) NOT NULL , 
`ADDRESS_ID` VARCHAR(20) NOT NULL ,
`ORDER_STATUS` BOOLEAN NOT NULL DEFAULT FALSE , 
`ORDER_INITIATE_TIME` DATETIME NULL , 
PRIMARY KEY (`ORDER_ID`),
FOREIGN KEY (USER_ID) REFERENCES USER(USER_ID),
FOREIGN KEY(ADDRESS_ID) REFERENCES ADDRESS(ADDRESS_ID)) ENGINE = InnoDB;

/*ORDER_CANCEL*/
CREATE TABLE `iMIuEwHYH8`.`ORDER_CANCEL` ( `ORDER_ID` VARCHAR(20) NOT NULL ,
`USER_ID` VARCHAR(20) NOT NULL ,
`PRODUCT_ID` VARCHAR(20) NOT NULL ,
`PRODUCT_UIN` VARCHAR(20) NOT NULL , 
PRIMARY KEY (`ORDER_ID`),
FOREIGN KEY (USER_ID) REFERENCES USER(USER_ID),
FOREIGN KEY(PRODUCT_ID,PRODUCT_UIN) REFERENCES PRODUCT_UIN_MAP(PRODUCT_ID,PRODUCT_UIN)) ENGINE = InnoDB;

/*SALES_REP*/
CREATE TABLE `SALES_REP` ( `USER_ID` VARCHAR(20),
                        
                         `TARGET` INT,
                         `TARGET_SALES` INT,
                         `CART_ID` VARCHAR(20),
                         `CURRENT_TARGET_SALES` INT,
                         PRIMARY KEY (`USER_ID`),
                          FOREIGN KEY(`USER_ID`) REFERENCES USER(`USER_ID`),
                          FOREIGN KEY(`CART_ID`) REFERENCES CART(`CART_ID`));
                          
/*RETAILER*/
CREATE TABLE `RETAILER`(`USER_ID` VARCHAR(20),
`DISCOUNT` DOUBLE,
`CART_ID` VARCHAR(20),
PRIMARY KEY(`USER_ID`),
FOREIGN KEY(`USER_ID`) REFERENCES USER(`USER_ID`),
FOREIGN KEY(`CART_ID`) REFERENCES CART(`CART_ID`));

/*ORDER_RETURN*/
CREATE TABLE `ORDER_RETURN` ( `ORDER_ID` VARCHAR(20) NOT NULL ,
`USER_ID` VARCHAR(20) NOT NULL ,
`PRODUCT_ID` VARCHAR(20) NOT NULL ,
`PRODUCT_UIN` VARCHAR(20) NOT NULL ,
`ORDER_RETURN_TIME` DATETIME,
`ORDER_RETURN_REASON` VARCHAR(50),
`ORDER_RETURN_STATUS` BOOLEAN NOT NULL DEFAULT FALSE,
PRIMARY KEY (`ORDER_ID`,`PRODUCT_ID`,`PRODUCT_UIN`),
FOREIGN KEY (`USER_ID`) REFERENCES USER(`USER_ID`),
FOREIGN KEY (`ORDER_ID`) REFERENCES USER(`USER_ID`),
FOREIGN KEY(`PRODUCT_ID`,`PRODUCT_UIN`) REFERENCES PRODUCT_UIN_MAP(`PRODUCT_ID`,`PRODUCT_UIN`)) ;

/*FREQUENTLY_ORDERED_LIST*/
CREATE TABLE `FREQUENTLY_ORDERED_LIST`(`USER_ID` VARCHAR(20),
`PRODUCT_ID` VARCHAR(20),
`ADDRESS_ID` VARCHAR(20),
PRIMARY KEY (`USER_ID`,`PRODUCT_ID`,`ADDRESS_ID`),
FOREIGN KEY(`USER_ID`) REFERENCES USER(`USER_ID`),
FOREIGN KEY(`PRODUCT_ID` ) REFERENCES PRODUCT(`PRODUCT_ID`),
FOREIGN KEY(`ADDRESS_ID`) REFERENCES ADDRESS(`ADDRESS_ID`));

/*ORDER_PRODUCT_MAP*/
	CREATE TABLE `ORDER_PRODUCT_MAP`(`ORDER_ID` VARCHAR(20),
	`PRODUCT_ID` VARCHAR(20),
	`PRODUCT_UIN` VARCHAR(20),
	`PRODUCT_STATUS` BOOLEAN NOT NULL DEFAULT FALSE,
	`GIFT_STATUS` BOOLEAN NOT NULL DEFAULT FALSE,
	PRIMARY KEY(`ORDER_ID`,`PRODUCT_ID`,`PRODUCT_UIN`),
	FOREIGN KEY (`ORDER_ID`) REFERENCES ORDER(`ORDER_ID`),
	FOREIGN KEY(`PRODUCT_ID`,`PRODUCT_UIN`) REFERENCES PRODUCT_UIN_MAP(` PRODUCT_ID`,`PRODUCT_UIN`));
